$(document).ready(function(){checkSubMenuPosition();$('#scroll').click(function(e){e.preventDefault();scrollToPixel(0);return!1});$('.play .cta a').each(function(e){var url=$(this).attr('href');$(this).click(function(e){e.preventDefault()});$(this).parent().parent().parent().parent().addClass('pseudo-link').click(function(){window.open(url)})});$("span[data-url]").click(function(){window.location.href=$(this).data('url')});$('.alertes input[name=subject]').removeAttr('required').hide();let hash=document.location.hash;let prefix="tab_";if(hash){$('.nav-tabs a[href="'+hash.replace(prefix,'')+'"]').tab('show')}
$('.nav-tabs a').on('shown.bs.tab',function(e){window.location.hash=e.target.hash.replace("#","#"+prefix)});let dtOptions={scrollX:!0,fixedHeader:!0,fixedColumns:!0,paging:!1,dom:'rt',buttons:[{extend:'colvis',columns:':gt(0)'}],language:{"emptyTable":"Aucune donnée disponible dans le tableau","buttons":{"colvis":"Colonnes à afficher",},"aria":{"sortAscending":": activer pour trier la colonne par ordre croissant","sortDescending":": activer pour trier la colonne par ordre décroissant"},},}
if(window.DataTable){jQuery.extend(jQuery.fn.dataTableExt.oSort,{"stars-pre":function(a){const nums=a.replace(/<span class="num etoile">(\d+)<\/span><span class="num etoile">(\d+)<\/span>/,"$1 $2").split(' ');const cmp=nums[0].toString()+((nums[1]<10)?'0'+nums[1].toString():nums[1].toString());return parseInt(cmp)},"stars-comma-asc":function(a,b){return((a<b)?-1:((a>b)?1:0))},"stars-comma-desc":function(a,b){return((a<b)?1:((a>b)?-1:0))}});if($('.table-stats.stars').length>0){jQuery.extend(dtOptions,{columnDefs:[{'type':'stars',targets:[0]}]});$('.table-stats.stars').DataTable(dtOptions)}else{$('.table-stats').DataTable(dtOptions)}}
$("#multiplesSelect").change(function(){var multiplier=$(this).val();$("#multiplesTable div.stripped div.w-15.text-right").each(function(e){if(undefined==$(this).data('nb')){$(this).data('nb',$(this).text())}
var newVal=$(this).data('nb')*multiplier;var digits=(multiplier<3)?1:0;newVal=newVal.toFixed(digits);if(newVal>0){if(multiplier>1){newVal+=' €'}
$(this).text(newVal)}else{$(this).text('')}})})});function getRndInteger(min,max){return Math.floor(Math.random()*(max-min+1))+min}
$(window).scroll(function(){if($(this).scrollTop()>200){$('#scroll').fadeIn()}else{$('#scroll').fadeOut()}});$(window).resize(function(){checkSubMenuPosition()});function numberFormat(num){return num.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,'$1 ').replace('.',',')}
function getOffset(el){const rect=el.getBoundingClientRect();return{left:rect.left+window.scrollX,top:rect.top+window.scrollY}}
function scrollToPixel(top){$("html, body").animate({scrollTop:top},600)}
function scrollToElementId(id){scrollToPixel(getOffset(document.getElementById(id)).top)}
function checkSubMenuPosition(){var submenu=$("ul.sub-menu");var section=submenu.data('section');switch(breakpoint){case 'xs':case 'sm':if(0==$("ul.main-menu").find('ul').length){submenu.appendTo($("#menu-"+section))}
break;case 'md':case 'lg':case 'xl':if(0==$("#sub-menu").find('ul').length){submenu.appendTo($("#sub-menu"))}
break}}
function calcGainsMultiples(){$("#calcMultiple").submit(function(e){let form=$(this);let btnSubmit=form.find('input[type=submit]');e.preventDefault();let action_url=form.attr("action");let form_data=form.serialize();let url=new URL(window.location.href);url.search=form_data;let pTitle=document.title.match(/multiples/)?document.title:'Calcul de gains multiples - '+document.title;history.pushState({},pTitle,url.toString());document.title=pTitle;btnSubmit.prop('disabled',!0).addClass('spinner');$.ajax({type:"GET",url:action_url,data:form_data,timeout:20000,success:function(response){if("ok"==response.status){form.find('div.alert').html(error_msg).removeClass('show');scrollToElementId('rapports-multiples');btnSubmit.prop('disabled',!1).removeClass('spinner');$("#multiple div.table-rapports.principal").removeClass('d-none').fadeIn();if(response.multi.hasError){$('div.multi-alert').removeClass('d-none')}else{$('div.multi-alert').addClass('d-none')}
$('div[class*=multi-nb], div[class*=multi-gain]').text('');for(let rang in response.multi.rangs){let item=response.multi.rangs[rang];$('div.multi-nb-'+rang).text(item.nb);$('div.multi-gain-'+rang).text(item.gain>0?numberFormat(item.nb*item.gain)+' €':'-')}
$("#multiple div.table-footer.total").removeClass('d-none').addClass('d-flex').fadeIn();$('div.multi-gain').text(numberFormat(response.multi.gain)+' €');if(undefined!=response.multi_second){$("#multiple div.table-rapports.second").removeClass('d-none').fadeIn();$("#multiple div.table-footer.subtotal.principal").removeClass('d-none').addClass('d-flex').fadeIn();if(response.multi_second.hasError){$('div.multi-alert').removeClass('d-none')}else{$('div.multi-alert').addClass('d-none')}
$('div[class*=multi-second-nb], div[class*=multi-second-gain]').text('');for(let rang in response.multi_second.rangs){let item=response.multi_second.rangs[rang];$('div.multi-second-nb-'+rang).text(item.nb);$('div.multi-second-gain-'+rang).text(item.gain>0?numberFormat(item.nb*item.gain)+' €':'-')}
$('div.multi-second-gain').text(numberFormat(response.multi_second.gain)+' €');$('.multi-total-gain').text(numberFormat(response.multi_second.gain+response.multi.gain)+' €')}else{$("#multiple div.table-rapports.second").addClass('d-none').fadeOut();$("#multiple div.table-footer.subtotal.principal").addClass('d-none').removeClass('d-flex').fadeIn();$('.multi-total-gain').text(numberFormat(response.multi.gain)+' €')}}else{let error_msg=undefined!=response.msg?response.msg:'Erreur inconnue !';form.find('div.alert').html(error_msg).addClass('show');btnSubmit.prop('disabled',!1).removeClass('spinner').val('Calculer')}},error:function(e){let error_msg=undefined!=e.responseText?e.responseText:'Erreur inconnue !';alert(error_msg);btnSubmit.prop('disabled',!1).removeClass('spinner').val('Calculer')}})})}
function changeOrdreTirage(){let sortState='asc';$("#changeSortOrder").click(function(e){if('asc'==sortState){$("ul.tirage.ascOrder").fadeOut().addClass('d-none').removeClass('d-flex');$("ul.tirage.drawOrder").fadeIn().addClass('d-flex').removeClass('d-none');sortState='draw';$(this).find('span').text('croissant')}else{$("ul.tirage.ascOrder").fadeIn().addClass('d-flex').removeClass('d-none');$("ul.tirage.drawOrder").fadeOut().addClass('d-none').removeClass('d-flex');sortState='asc';$(this).find('span').text('de sortie')}})}
function afficheCodes(){$("#showCodes").click(function(e){let nb=$(this).data('nb');nb=(nb>0?nb:10)-1;console.log(nb);if('Suite...'==$(this).text()){$(this).siblings().fadeIn().removeClass('d-none');$(this).text('Masquer').addClass('active').parent().removeClass('justify-content-center').addClass('justify-content-between')}else{$(this).siblings(':gt('+nb+')').fadeOut().addClass('d-none');$(this).text('Suite...').removeClass('active').parent().removeClass('justify-content-between').addClass('justify-content-center')}})}
function rechercheTiragesLoto(){$('[data-toggle="tooltip"]').tooltip();lotoDatePicker();if($(".recherche-tirages").length>0){$(".recherche-tirages form").each(function(i){let mpForm=$(this);let mpInput=mpForm.find('input[type=text]');let mpType=mpForm.data('type');mpForm.submit(function(e){e.preventDefault();let action_url=mpForm.attr("action");let form_data=mpForm.serialize();mpInput.prop('disabled',!0).removeClass(['error','calendar']).addClass('spinner');mpForm.find('small').remove();$.ajax({type:"POST",url:action_url,data:form_data,timeout:20000,success:function(response){if("ok"==response.status){window.location.href=response.url;setTimeout(function(){mpInput.prop('disabled',!1).removeClass('spinner').addClass('calendar')},2000)}else{let error_msg=undefined!=response.msg?response.msg:'Erreur inconnue !';mpForm.append('<small class="text-danger d-block">'+error_msg+'</small>');mpInput.prop('disabled',!1).removeClass('spinner').addClass('error')}},error:function(e){let error_msg=undefined!=e.responseText?e.responseText:'Erreur inconnue !';alert(error_msg);mpInput.prop('disabled',!1).removeClass('spinner').addClass('calendar')}})})})}}
function rechercheTiragesEuromillions(){$('[data-toggle="tooltip"]').tooltip();eurosDatePicker();if($(".recherche-tirages").length>0){$(".recherche-tirages form").each(function(i){let mpForm=$(this);let mpInput=mpForm.find('input[type=text]');let mpType=mpForm.data('type');mpForm.submit(function(e){e.preventDefault();let action_url=mpForm.attr("action");let form_data=mpForm.serialize();mpInput.prop('disabled',!0).removeClass(['error','calendar']).addClass('spinner');mpForm.find('small').remove();$.ajax({type:"POST",url:action_url,data:form_data,timeout:20000,success:function(response){if("ok"==response.status){window.location.href=response.url;setTimeout(function(){mpInput.prop('disabled',!1).removeClass('spinner').addClass('calendar')},2000)}else{let error_msg=undefined!=response.msg?response.msg:'Erreur inconnue !';mpForm.append('<small class="text-danger d-block">'+error_msg+'</small>');mpInput.prop('disabled',!1).removeClass('spinner').addClass('error')}},error:function(e){let error_msg=undefined!=e.responseText?e.responseText:'Erreur inconnue !';alert(error_msg);mpInput.prop('disabled',!1).removeClass('spinner').addClass('calendar')}})})})}}
function calcGenerateurGrilles(){$("#generateur").submit(function(e){let form=$(this);let btnSubmit=form.find('input[type=submit]');e.preventDefault();let action_url=form.attr("action");let form_data=form.serialize();let url=new URL(window.location.href);url.search=form_data;let pTitle=document.title.match(/Vos/)?document.title:'Vos combinaisons aléatoires - '+document.title;history.pushState({},pTitle,url.toString());document.title=pTitle;btnSubmit.prop('disabled',!0).addClass('spinner');form.find('div.alert').html('').addClass('d-none');$("#resultats-generateur").removeClass('d-none').fadeIn();$(".liste-grilles").slideUp(600,function(){$(this).html('');$.ajax({type:"GET",url:action_url,data:form_data,timeout:20000,success:function(response){if("ok"==response.status){scrollToElementId('resultats-generateur');for(i=0;i<response.grilles.length;i++){let html='<div class="stripped '+(i%2>0?'even':'odd')+'">';let grille=response.grilles[i];html+='<ul class="tirage '+form.data('jeu')+'">';grille.numeros.forEach(function(numero){html+='<li class="numero">'+numero+'</li>'});grille.complement.forEach(function(numero){html+='<li class="'+('loto'==form.data('jeu')?'chance':'etoile')+'">'+numero+'</li>'});html+='</ul>';html+='</div>';$(".liste-grilles").append(html)}
$(".liste-grilles").removeClass('d-none').slideDown(1000);btnSubmit.prop('disabled',!1).removeClass('spinner')}else{scrollToElementId('generateur');let error_msg=undefined!=response.msg?response.msg:'Erreur inconnue !';form.find('div.alert').html(error_msg).removeClass('d-none');btnSubmit.prop('disabled',!1).removeClass('spinner')}},error:function(e){scrollToElementId('generateur');let error_msg=undefined!=e.responseText?e.responseText:'Erreur inconnue !';form.find('div.alert').html(error_msg).removeClass('d-none');btnSubmit.prop('disabled',!1).removeClass('spinner')}})})})}
function verifieGainsLoto(){$('[data-toggle="tooltip"]').tooltip()
lotoDatePicker();initMask();const grillesValides={51:1,52:2,53:3,54:4,55:5,56:6,57:7,58:8,59:9,510:10,61:6,62:12,63:18,64:24,65:30,66:36,67:42,68:48,69:54,610:10,71:21,72:42,73:63,74:84,75:105,76:126,77:147,78:165,81:56,82:112,83:168,91:126,};const maxCompByNum=[10,10,10,10,10,10,10,8,3,1];const maxNumByComp=[9,9,8,8,7,7,7,7,7,6,6];const minNums=5;const minComp=1;const compName='chance';let currentGrille,$checkedNums,$checkedComp;function updateCounts(){currentSelector="#liste-grilles div.current ";$checkedNums=$("input[name^=nums]:checked").length;$checkedComp=$("input[name^=comp]:checked").length}
$("input[name^=nums]").click(function(e){updateCounts();$(currentSelector+"div.text-danger").remove();if(!0==$(this).prop('checked')){if($checkedNums>=maxNumByComp[$checkedComp]){$(this).prop('checked',!1);$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' numéro(s) Chance':'')+'</div>')}else{if(0==$(currentSelector+"span.numeros span.empty").length){$(currentSelector+"span.numeros span").after('<span class="ok">'+$(this).val()+'</span>')}else{$(currentSelector+"span.numeros span.empty:first").text($(this).val()).addClass('ok').removeClass('empty')}
sortNums('numeros')}}else{let removeVal=parseInt($(this).val());$(currentSelector+"span.numeros span").each(function(){if($(this).text()==removeVal){$(this).remove();if($(currentSelector+"span.numeros span").length<5){$(currentSelector+"span.numeros span:last").after('<span class="empty"></span>')}}})}
isCurrentGrilleValide(!0,!0,!1)});$("input[name^=comp]").click(function(e){updateCounts();$(currentSelector+"div.text-danger").remove();if(!0==$(this).prop('checked')){if($checkedComp>=maxCompByNum[$checkedNums]){$(this).prop('checked',!1);$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' numéro(s) Chance':'')+'</div>')}else{if(0==$(currentSelector+"span."+compName+" span.empty").length){$(currentSelector+"span."+compName+" span").after('<span class="ok">'+$(this).val()+'</span>')}else{$(currentSelector+"span."+compName+" span.empty:first").text($(this).val()).addClass('ok').removeClass('empty')}
sortNums(compName)}}else{let removeVal=parseInt($(this).val());$(currentSelector+"span."+compName+" span").each(function(){if($(this).text()==removeVal){$(this).remove();if($(currentSelector+"span."+compName+" span").length==0){$(currentSelector+"span."+compName).append('<span class="empty"></span>')}}})}
isCurrentGrilleValide(!0,!0,!1)});function ajouteGrille(){const $template=$("#grille-template div.stripped").clone();let total=$("#liste-grilles div.stripped").length;$template.addClass(total%2==0?'odd':'even').addClass('current');$("input[name^=nums], input[name^=comp]").prop('checked',!1);$("#liste-grilles").append($template)}
function checkAllGrilles(){if($("#liste-grilles div.current.invalid").length>0){$(currentSelector+"div.text-danger").remove();$("#liste-grilles div.current.invalid").each(function(){$(currentSelector).append('<div class="small text-danger">Vous devez choisir au moins '+minNums+' numéros et '+minComp+' numéro(s) Chance</div>')});return!1}else{return!0}}
function isCurrentGrilleValide(checkSimple,checkMulti,addErrorMsg){updateCounts();$(currentSelector).removeClass('invalid valid empty');if(!0==addErrorMsg){$(currentSelector+"div.text-danger").remove()}
$(currentSelector+"div.small.type").remove();if(0==$checkedNums&&0==$checkedComp){$(currentSelector).addClass('empty');return!0}
if($checkedNums<5||$checkedComp==0){if(checkSimple&&addErrorMsg){$(currentSelector).append('<div class="small text-danger">Vous devez choisir au moins 5 numéros et 1 numéro Chance !</div>')}
$(currentSelector).addClass('invalid');return!1}else if($checkedNums>=maxNumByComp[$checkedComp]||$checkedComp>=maxCompByNum[$checkedNums]){if(checkMulti&&addErrorMsg){$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' numéro(s) Chance':'')+'</div>')}
$(currentSelector).addClass('invalid');return!1}else{console.log('ok');if(5==$checkedNums&&1==$checkedComp){$(currentSelector).append('<div class="small type">Grille simple à <strong>2,2€</strong></div>')}else{let idx=parseInt(''+$checkedNums+''+$checkedComp+'');$(currentSelector).append('<div class="small type">Grille multiple à <strong>'+(Math.round((grillesValides[idx]*2.2)*100)/100).toString().replace('.',',')+'€</strong></div>')}
let type=(5==$checkedNums&&1==$checkedComp)?'simple':'multiple';$(currentSelector).append('<div class="small type"></div>');$(currentSelector).addClass('valid');return!0}}
$("#ajoute-grille").click(function(e){if(isCurrentGrilleValide(!0,!0,!0)){$("#liste-grilles div.stripped").removeClass('current').addClass('inactive');if($("#liste-grilles div.stripped.empty").length==0){ajouteGrille()}else{$("#liste-grilles div.stripped.empty").removeClass('inactive').addClass('current');$("input[name^=nums], input[name^=comp]").prop('checked',!1)}}});$("#liste-grilles").on('click','div.trash',function(e){e.stopPropagation();let parent=$(this).parent();if(parent.hasClass('current')){$("input[name^=nums], input[name^=comp]").prop('checked',!1)}
parent.remove();if($("#liste-grilles div.stripped.empty").length==0&&$("#liste-grilles div.stripped.invalid").length==0){ajouteGrille()}else if($("#liste-grilles div.stripped.current").length==0){$("#liste-grilles div.stripped:last").addClass('current').removeClass('inactive')}
let i=0;$("#liste-grilles div.stripped").each(function(idx,elt){$(this).removeClass('odd even').addClass(i%2==0?'odd':'even');i++})});$("#liste-grilles").on('click','div.edit',function(e){e.stopPropagation();if(isCurrentGrilleValide(!0,!0,!0)){$("input[name^=nums], input[name^=comp]").prop('checked',!1);$("#liste-grilles div.stripped.current").removeClass('current').addClass('inactive');$(this).parent().removeClass('inactive').addClass('current');$(this).parent().children('span.numeros').children('span').each(function(){if($(this).text()!=""){$("input[name^=nums][value="+$(this).text()+"]").prop('checked',!0)}});$(this).parent().children('span.'+compName).children('span').each(function(){if($(this).text()!=""){$("input[name^=comp][value="+$(this).text()+"]").prop('checked',!0)}})}});ajouteGrille();function sortNums(type){var $fields,$container,sorted,index;$container=$('div.stripped.current span.numboxes.'+type);$fields=$('span',$container);sorted=[];$fields.detach().each(function(){sorted[(100-parseInt($(this).text()))]=this});sorted.forEach(function(element){if('numeros'==type){$container.prepend(element)}else{$container.append(element)}});let max='numeros'==type?5:1;for(i=$('div.stripped.current span.'+type+' span.ok').length;i<max;i++){$container.find('span:last').after('<span class="empty"></span>')}}
$("#calc-gains").click(function(e){let btnSubmit=$(this);e.preventDefault();btnSubmit.prop('disabled',!0).addClass('spinner');$('#grilles div.alert').html('').addClass('d-none');$("#resultats-calcul").removeClass('d-none').fadeIn();let grilles='';$("#liste-grilles div.stripped").each(function(){let grille='';let nums=[],comp=[];$(this).find("span.numeros span.ok").each(function(){grille+=$(this).text()+'-';nums.push($(this).text())});grille=grille.substr(0,grille.length-1)+',';$(this).find("span."+compName+" span.ok").each(function(){grille+=$(this).text()+'-';comp.push($(this).text())});grille=grille.substr(0,grille.length-1);let idx=nums.length+''+comp.length;if(undefined!=grillesValides[idx]){grilles+=(''!=grilles?'|':'')+grille}else if(nums.length>0&&comp.length>0){$(this).removeClass('inactive').append('<div class="small text-danger">Grille invalide, veuillez la corriger !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}});let dates=$(".recherche-tirages-grilles input").val();if(''==dates){$(".recherche-tirages-grilles").append('<div class="small text-danger">Veuillez choisir une date ou un intervalle de dates !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}
let second=!0==$("#second").prop('checked')?1:0;let url=new URL($("#grilles").data('action-url'));url.searchParams.set('dates',dates);url.searchParams.set('grilles',grilles);url.searchParams.set('second',second);let decUrl=decodeURIComponent(url.toString());window.location.href=decUrl});function initMask(){new InputMask().Initialize(document.querySelectorAll("div.code.current input"),{mask:'A 9999 9999',placeHolder:"A 1234 5678",forceUpper:!0,})}
function checkCurrentCode(){$("#liste-codes .code.current div.small").remove();let code=$("#liste-codes .code.current input").val();if(""!=code&&!1==/^[a-zA-Z]{1} ?[0-9]{4} ?[0-9]{4}$/.test(code)){$("#liste-codes .code.current").append('<div class="small text-danger">Code Loto invalide !</div>');return!1}
return!0}
function ajouteCode(doCheck){if((doCheck&&checkCurrentCode()&&!checkIfEmptyCodeExists())||!doCheck){$("#liste-codes .code").removeClass('current').addClass('inactive');$("#liste-codes .code input").prop('disabled',!0);const $template=$("#code-template div.code").clone();$("#liste-codes").append($template);initMask()}}
function checkIfEmptyCodeExists(){let test=0;$("#liste-codes div.code input").each(function(){if(""==$(this).val()){test++}});let res=test>0?true:!1;console.log('checkIfEmptyCodeExists:'+test+'-'+res);return res}
$("#ajoute-code").click(function(e){ajouteCode(!0)});$("#liste-codes").on('click','div.trash',function(e){e.stopPropagation();let parent=$(this).parent();parent.remove();if(!checkIfEmptyCodeExists()){ajouteCode(!1)}});$("#liste-codes").on('click','div.edit',function(e){e.stopPropagation();if(checkCurrentCode()){$("#liste-codes div.code").removeClass('current').addClass('inactive').find('input').prop('disabled',!0);$(this).parent().removeClass('inactive').addClass('current').find('input').prop('disabled',!1).focus()}});$("#calc-codes").click(function(e){let btnSubmit=$(this);e.preventDefault();btnSubmit.prop('disabled',!0).addClass('spinner');let dates=$(".recherche-tirages-codes input").val();if(''==dates){$(".recherche-tirages-codes").append('<div class="small text-danger">Veuillez choisir une date ou un intervalle de dates !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}
let codes=[];$("#liste-codes input").each(function(){if(""!=$(this).val()){codes.push($(this).val())}});let url=new URL($("#grilles").data('action-url'));url.searchParams.set('dates',dates);url.searchParams.set('codes',codes);let decUrl=decodeURIComponent(url.toString());window.location.href=decUrl+'#tab_codes'})}
function verifieGainsEuromillions(){$('[data-toggle="tooltip"]').tooltip()
eurosDatePicker();initMask();const grillesValides={52:1,53:3,54:6,55:10,56:15,57:21,58:28,59:36,510:45,511:55,512:66,62:6,63:18,64:36,65:60,66:90,67:126,68:168,69:216,610:270,611:330,612:396,72:21,73:63,74:126,75:210,76:315,82:56,83:168,84:336,92:126,93:378,102:252,};const maxCompByNum=[12,12,12,12,12,12,6,4,3,2];const maxNumByComp=[10,10,9,8,7,7,6,6];const minNums=5;const minComp=2;const compName='etoiles';let currentGrille,$checkedNums,$checkedComp;function updateCounts(){currentSelector="#liste-grilles div.current ";$checkedNums=$("input[name^=nums]:checked").length;$checkedComp=$("input[name^=comp]:checked").length}
$("input[name^=nums]").click(function(e){updateCounts();$(currentSelector+"div.text-danger").remove();if(!0==$(this).prop('checked')){if($checkedNums>=maxNumByComp[$checkedComp]){$(this).prop('checked',!1);$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' étoiles':'')+'</div>')}else{if(0==$(currentSelector+"span.numeros span.empty").length){$(currentSelector+"span.numeros span").after('<span class="ok">'+$(this).val()+'</span>')}else{$(currentSelector+"span.numeros span.empty:first").text($(this).val()).addClass('ok').removeClass('empty')}
sortNums('numeros')}}else{let removeVal=parseInt($(this).val());$(currentSelector+"span.numeros span").each(function(){if($(this).text()==removeVal){$(this).remove();if($(currentSelector+"span.numeros span").length<5){$(currentSelector+"span.numeros span:last").after('<span class="empty"></span>')}}})}
isCurrentGrilleValide(!0,!0,!1)});$("input[name^=comp]").click(function(e){updateCounts();$(currentSelector+"div.text-danger").remove();if(!0==$(this).prop('checked')){if($checkedComp>=maxCompByNum[$checkedNums]){$(this).prop('checked',!1);$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' étoiles':'')+'</div>')}else{if(0==$(currentSelector+"span."+compName+" span.empty").length){$(currentSelector+"span."+compName+" span").after('<span class="ok">'+$(this).val()+'</span>')}else{$(currentSelector+"span."+compName+" span.empty:first").text($(this).val()).addClass('ok').removeClass('empty')}
sortNums(compName)}}else{let removeVal=parseInt($(this).val());$(currentSelector+"span."+compName+" span").each(function(){if($(this).text()==removeVal){$(this).remove();if($(currentSelector+"span."+compName+" span").length==0){$(currentSelector+"span."+compName).append('<span class="empty"></span>')}}})}
isCurrentGrilleValide(!0,!0,!1)});function ajouteGrille(){const $template=$("#grille-template div.stripped").clone();let total=$("#liste-grilles div.stripped").length;$template.addClass(total%2==0?'odd':'even').addClass('current');$("input[name^=nums], input[name^=comp]").prop('checked',!1);$("#liste-grilles").append($template)}
function checkAllGrilles(){if($("#liste-grilles div.current.invalid").length>0){$(currentSelector+"div.text-danger").remove();$("#liste-grilles div.current.invalid").each(function(){$(currentSelector).append('<div class="small text-danger">Vous devez choisir au moins '+minNums+' numéros et '+minComp+' étoiles</div>')});return!1}else{return!0}}
function isCurrentGrilleValide(checkSimple,checkMulti,addErrorMsg){updateCounts();$(currentSelector).removeClass('invalid valid empty');if(!0==addErrorMsg){$(currentSelector+"div.text-danger").remove()}
$(currentSelector+"div.small.type").remove();if(0==$checkedNums&&0==$checkedComp){$(currentSelector).addClass('empty');return!0}
if($checkedNums<5||$checkedComp<2){if(checkSimple&&addErrorMsg){$(currentSelector).append('<div class="small text-danger">Vous devez choisir au moins '+minNums+' numéros et '+minComp+' étoiles !</div>')}
$(currentSelector).addClass('invalid');return!1}else if($checkedNums>=maxNumByComp[$checkedComp]||$checkedComp>=maxCompByNum[$checkedNums]){if(checkMulti&&addErrorMsg){$(currentSelector).append('<div class="small text-danger">Vous ne pouvez pas sélectionner plus de '+$checkedNums+' numéros'+($checkedComp>0?' avec '+$checkedComp+' étoiles':'')+'</div>')}
$(currentSelector).addClass('invalid');return!1}else if($checkedNums>=5&&$checkedComp>=2){if(5==$checkedNums&&2==$checkedComp){$(currentSelector).append('<div class="small type">Grille simple à <strong>2,5€</strong></div>')}else{let idx=parseInt(''+$checkedNums+''+$checkedComp+'');$(currentSelector).append('<div class="small type">Grille multiple à <strong>'+(Math.round((grillesValides[idx]*2.5)*100)/100).toString().replace('.',',')+'€</strong></div>')}
let type=(5==$checkedNums&&2==$checkedComp)?'simple':'multiple';$(currentSelector).append('<div class="small type"></div>');$(currentSelector).addClass('valid');return!0}}
$("#ajoute-grille").click(function(e){if(isCurrentGrilleValide(!0,!0,!0)){$("#liste-grilles div.stripped").removeClass('current').addClass('inactive');if($("#liste-grilles div.stripped.empty").length==0){ajouteGrille()}else{$("#liste-grilles div.stripped.empty").removeClass('inactive').addClass('current');$("input[name^=nums], input[name^=comp]").prop('checked',!1)}}});$("#liste-grilles").on('click','div.trash',function(e){e.stopPropagation();let parent=$(this).parent();if(parent.hasClass('current')){$("input[name^=nums], input[name^=comp]").prop('checked',!1)}
parent.remove();if($("#liste-grilles div.stripped.empty").length==0&&$("#liste-grilles div.stripped.invalid").length==0){ajouteGrille()}else if($("#liste-grilles div.stripped.current").length==0){$("#liste-grilles div.stripped:last").addClass('current').removeClass('inactive')}
let i=0;$("#liste-grilles div.stripped").each(function(idx,elt){$(this).removeClass('odd even').addClass(i%2==0?'odd':'even');i++})});$("#liste-grilles").on('click','div.edit',function(e){e.stopPropagation();if(isCurrentGrilleValide(!0,!0,!0)){$("input[name^=nums], input[name^=comp]").prop('checked',!1);$("#liste-grilles div.stripped.current").removeClass('current').addClass('inactive');$(this).parent().removeClass('inactive').addClass('current');$(this).parent().children('span.numeros').children('span').each(function(){if($(this).text()!=""){$("input[name^=nums][value="+$(this).text()+"]").prop('checked',!0)}});$(this).parent().children('span.'+compName).children('span').each(function(){if($(this).text()!=""){$("input[name^=comp][value="+$(this).text()+"]").prop('checked',!0)}})}});ajouteGrille();function sortNums(type){var $fields,$container,sorted,index;$container=$('div.stripped.current span.numboxes.'+type);$fields=$('span',$container);sorted=[];$fields.detach().each(function(){sorted[(100-parseInt($(this).text()))]=this});sorted.forEach(function(element){if('numeros'==type){$container.prepend(element)}else{$container.append(element)}});let max='numeros'==type?5:1;for(i=$('div.stripped.current span.'+type+' span.ok').length;i<max;i++){$container.find('span:last').after('<span class="empty"></span>')}}
$("#calc-gains").click(function(e){let btnSubmit=$(this);e.preventDefault();btnSubmit.prop('disabled',!0).addClass('spinner');$('#grilles div.alert').html('').addClass('d-none');$("#resultats-calcul").removeClass('d-none').fadeIn();let grilles='';$("#liste-grilles div.stripped").each(function(){let grille='';let nums=[],comp=[];$(this).find("span.numeros span.ok").each(function(){grille+=$(this).text()+'-';nums.push($(this).text())});grille=grille.substr(0,grille.length-1)+',';$(this).find("span."+compName+" span.ok").each(function(){grille+=$(this).text()+'-';comp.push($(this).text())});grille=grille.substr(0,grille.length-1);let idx=nums.length+''+comp.length;if(undefined!=grillesValides[idx]){grilles+=(''!=grilles?'|':'')+grille}else if(nums.length>0&&comp.length>0){$(this).removeClass('inactive').append('<div class="small text-danger">Grille invalide, veuillez la corriger !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}});let dates=$(".recherche-tirages-grilles input").val();if(''==dates){$(".recherche-tirages-grilles").append('<div class="small text-danger">Veuillez choisir une date ou un intervalle de dates !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}
let etoileplus=!0==$("#etoileplus").prop('checked')?1:0;let url=new URL($("#grilles").data('action-url'));url.searchParams.set('dates',dates);url.searchParams.set('grilles',grilles);url.searchParams.set('etoileplus',etoileplus);let decUrl=decodeURIComponent(url.toString());window.location.href=decUrl});function initMask(){new InputMask().Initialize(document.querySelectorAll("div.code.current input"),{mask:'AA 999 9999',placeHolder:"AB 123 4567",forceUpper:!0,})}
function checkCurrentCode(){$("#liste-codes .code.current div.small").remove();let code=$("#liste-codes .code.current input").val();if(""!=code&&!1==/^[a-zA-Z]{2} ?[0-9]{3} ?[0-9]{4}$/.test(code)){$("#liste-codes .code.current").append('<div class="small text-danger">Code My Million invalide !</div>');return!1}
return!0}
function ajouteCode(doCheck){if((doCheck&&checkCurrentCode()&&!checkIfEmptyCodeExists())||!doCheck){$("#liste-codes .code").removeClass('current').addClass('inactive');$("#liste-codes .code input").prop('disabled',!0);const $template=$("#code-template div.code").clone();$("#liste-codes").append($template);initMask()}}
function checkIfEmptyCodeExists(){let test=0;$("#liste-codes div.code input").each(function(){if(""==$(this).val()){test++}});let res=test>0?true:!1;console.log('checkIfEmptyCodeExists:'+test+'-'+res);return res}
$("#ajoute-code").click(function(e){ajouteCode(!0)});$("#liste-codes").on('click','div.trash',function(e){e.stopPropagation();let parent=$(this).parent();parent.remove();if(!checkIfEmptyCodeExists()){ajouteCode(!1)}});$("#liste-codes").on('click','div.edit',function(e){e.stopPropagation();if(checkCurrentCode()){$("#liste-codes div.code").removeClass('current').addClass('inactive').find('input').prop('disabled',!0);$(this).parent().removeClass('inactive').addClass('current').find('input').prop('disabled',!1).focus()}});$("#calc-codes").click(function(e){let btnSubmit=$(this);e.preventDefault();btnSubmit.prop('disabled',!0).addClass('spinner');let dates=$(".recherche-tirages-codes input").val();if(''==dates){$(".recherche-tirages-codes").append('<div class="small text-danger">Veuillez choisir une date ou un intervalle de dates !</div>');btnSubmit.prop('disabled',!1).removeClass('spinner');return}
let codes=[];$("#liste-codes input").each(function(){if(""!=$(this).val()){codes.push($(this).val())}});let url=new URL($("#grilles").data('action-url'));url.searchParams.set('dates',dates);url.searchParams.set('codes',codes);let decUrl=decodeURIComponent(url.toString());window.location.href=decUrl+'#tab_codes'})}
function rechercherTirages(jeu){$('[data-toggle="tooltip"]').tooltip();if('loto'==jeu){lotoDatePicker()}else{eurosDatePicker()}}
function lotoDatePicker(){$("input.lotodatepicker").each(function(){let dateMin=$(this).data('date-min');let type=$(this).data('type');let curForm=$(this).parents('form');$(this).datepicker({minView:undefined!=type?type:"days",view:undefined!=type?type:"days",dateFormat:"months"==type?"mm/yyyy":"dd/mm/yyyy",toggleSelected:!1,autoClose:!0,language:"fr",multipleDatesSeparator:" au ",minDate:new Date(dateMin),maxDate:new Date(),onRenderCell:function(date,cellType){if(cellType=='day'){let formattedDate=date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate();let lotoDays=[1,3,6];let superlotoDays=['2009-11-13','2009-03-13','2009-2-13','2010-8-13','2010-12-24','2010-12-31','2011-4-01','2011-5-13','2012-1-13','2012-4-13','2012-7-13','2012-10-12','2013-04-05','2013-12-13','2013-09-13','2014-02-14','2014-06-13','2015-02-13','2015-03-13','2015-11-13','2016-05-13','2016-09-16','2017-01-13','2017-10-13','2017-12-22','2018-04-13','2018-07-13','2018-9-14','2018-12-25','2019-7-14','2019-9-13','2019-12-13','2019-12-24','2020-2-14','2020-3-13','2020-11-13','2020-12-25','2020-12-31','2021-2-12','2021-5-21','2021-8-13','2021-12-24','2021-12-31','2022-4-01','2022-5-13','2022-7-01','2022-9-19','2022-10-07'];let isSuperLoto=(superlotoDays.indexOf(formattedDate)!=-1)&&(formattedDate>=dateMin);let isLoto=lotoDays.indexOf(date.getDay())!=-1;let isDisabled=(!isSuperLoto&&!isLoto)?!0:!1;return{disabled:isDisabled}}},onSelect:function(formattedDate,date,inst){if(undefined!=curForm.data('autosubmit')){curForm.submit()}}})})}
function eurosDatePicker(){$("input.eurosdatepicker").each(function(){let dateMin=$(this).data('date-min');let type=$(this).data('type');let curForm=$(this).parents('form');$(this).datepicker({minView:undefined!=type?type:"days",view:undefined!=type?type:"days",dateFormat:"months"==type?"mm/yyyy":"dd/mm/yyyy",toggleSelected:!1,autoClose:!0,language:"fr",multipleDatesSeparator:" au ",minDate:new Date(dateMin),maxDate:new Date(),onRenderCell:function(date,cellType){if(cellType=='day'){let eurosDays=[2,5];let isEuros=eurosDays.indexOf(date.getDay())!=-1;return{disabled:!isEuros}}},onSelect:function(formattedDate,date,inst){if(undefined!=curForm.data('autosubmit')){curForm.submit()}}})})}
function changeCountry(country){$('.country-change').removeClass('active');if('be'==country){$('div.col-be').removeClass('d-none');$('div.col-fr').addClass('d-none');$('.country-change.be').addClass('active')}else{$('div.col-fr').removeClass('d-none');$('div.col-be').addClass('d-none');$('.country-change.fr').addClass('active')}}